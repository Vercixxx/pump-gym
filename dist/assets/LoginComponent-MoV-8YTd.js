import{d as q,r as p,u as O,c as C,a as $,b as n,o as I,e as P,w as t,f as d,n as U,g as o,h as r,i as z,s as F,j as R,k as W,l as M,m as G,p as H,q as J,t as K,v as Q,x as X,y as Y}from"./index-D1Aaj6Hj.js";import{_ as Z}from"./_plugin-vue_export-helper-DlAUqK2U.js";const L=v=>(X("data-v-6697d287"),v=v(),Y(),v),ee={class:"grid grid-flow-col justify-stretch",align:"center"},oe={class:"text-subtitle-1 text-medium-emphasis d-flex align-end justify-space-between"},te=L(()=>d("span",null,null,-1)),ae=L(()=>d("div",{class:"w-100 border-y border-indigo-600 my-4 mt-5"},null,-1)),se=q({__name:"LoginComponent",setup(v){const _=p(!1),x=p(!1),h=p(""),D=p(""),f=p(!1),E=p({emailRules:[e=>!!e||"Email",e=>e.length>=6||"Email must containt at least 6 characters",e=>e.length<=70||"Email too large",e=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)||"Invalid email format (example@ex.ex)"],passwordRules:[e=>!!e||"Password is required",e=>e.length>=4||"Password must containt at least 4 characters",e=>e.length<=70||"Password too large"]}),i=O(),y=C(()=>i.loginDialog);function S(){i.closeLoginDialog()}const N=()=>{i.openSignUpDialog(),i.closeLoginDialog()},A=async()=>{x.value=!0;try{const e=h.value.trim(),a=D.value.trim();await F(R,W);const s=await M(R,e,a),u=G(H,"users",s.user.uid),w=(await J(u)).data();try{const g=K(u,"subscription"),c=(await Q(g)).docs.map(b=>b.data())[0];c.endDate=c.end_date.toDate().toISOString().split("T")[0],c.startDate=c.start_date.toDate().toISOString().split("T")[0],i.setUserData({...w,subscription:c},s.user.uid)}catch{console.log("No subscription data found"),i.setUserData({...w},s.user.uid)}S()}catch(e){console.log(e),e.code==="auth/invalid-credential"?store.dispatch("triggerAlert",{message:"Wrong email or password",type:"error"}):store.dispatch("triggerAlert",{message:"An error occurred",type:"error"})}x.value=!1},B=()=>{i.openPasswordResetDialog(),i.closeLoginDialog()},T=$(),V=C(()=>T.name.value==="dark");return(e,a)=>{const s=n("v-col"),u=n("v-btn"),m=n("v-row"),w=n("v-card-title"),g=n("v-text-field"),k=n("v-form"),c=n("v-tooltip"),b=n("v-icon"),j=n("v-dialog");return I(),P(j,{modelValue:y.value,"onUpdate:modelValue":a[5]||(a[5]=l=>y.value=l),persistent:"",width:"500",style:{"background-color":"rgba(50, 50, 50, 0.8)"}},{default:t(()=>[d("div",{class:U(["rounded-xl pa-4 border-4 border-indigo-900",V.value?"bg-slate-900":"bg-slate-200"])},[o(w,null,{default:t(()=>[o(m,null,{default:t(()=>[o(s,{cols:"2"}),o(s,{cols:"8",class:"headline text-h4",align:"center"},{default:t(()=>[r(" Sign in ")]),_:1}),o(s,{cols:"2",align:"end"},{default:t(()=>[o(u,{icon:"mdi-close",variant:"plain",onClick:S})]),_:1})]),_:1})]),_:1}),d("div",ee,[o(k,{modelValue:_.value,"onUpdate:modelValue":a[3]||(a[3]=l=>_.value=l)},{default:t(()=>[o(g,{modelValue:h.value,"onUpdate:modelValue":a[0]||(a[0]=l=>h.value=l),label:"Email",class:"mb-7 w-75",variant:"outlined","prepend-icon":"mdi-email",autocomplete:"username",rules:E.value.emailRules},null,8,["modelValue","rules"]),o(g,{modelValue:D.value,"onUpdate:modelValue":a[1]||(a[1]=l=>D.value=l),class:"w-75",label:"Password",variant:"outlined",type:f.value?"text":"password","prepend-icon":"mdi-key","append-inner-icon":f.value?"mdi-eye":" mdi-eye-off","onClick:appendInner":a[2]||(a[2]=l=>f.value=!f.value),autocomplete:"current-password"},null,8,["modelValue","type","append-inner-icon"]),d("div",oe,[te,o(u,{variant:"plain",size:"small",onClick:B,class:"text-cyan-darken-4 font-weight-bold","prepend-icon":"mdi-restore"},{default:t(()=>[r(" Forgot password? ")]),_:1})])]),_:1},8,["modelValue"])]),o(m,{class:"my-5"},{default:t(()=>[o(s,{cols:"12",align:"center"},{default:t(()=>[d("span",null,[_.value?z("",!0):(I(),P(c,{key:0,activator:"parent",location:"top","no-overflow":""},{default:t(()=>[r(" Fill required fields ")]),_:1})),d("span",null,[o(u,{class:U([V.value?"":"text-black","loginButton w-50 hover:text-white"]),disabled:!_.value,onClick:a[4]||(a[4]=l=>A())},{default:t(()=>[r(" Sign in "),o(b,{right:""},{default:t(()=>[r("mdi-login")]),_:1})]),_:1},8,["class","disabled"])])])]),_:1})]),_:1}),ae,o(m,null,{default:t(()=>[o(s,{cols:"12",align:"center"},{default:t(()=>[r(" Or ")]),_:1})]),_:1}),o(m,{class:"mb-4 mt-4"},{default:t(()=>[o(s,{cols:"12",align:"center"},{default:t(()=>[d("button",{class:"cursor-pointer text-white font-bold shadow-md hover:scale-[1.2] shadow-purple-400 rounded-full px-5 py-2 bg-gradient-to-bl from-purple-500 to-purple-800",onClick:N},[r(" Sign up now "),o(b,{right:""},{default:t(()=>[r("mdi-account-plus")]),_:1})])]),_:1})]),_:1})],2)]),_:1},8,["modelValue"])}}}),ie=Z(se,[["__scopeId","data-v-6697d287"]]);export{ie as default};
